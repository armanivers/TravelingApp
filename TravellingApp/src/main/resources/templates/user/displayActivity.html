<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<title>[[${activity.name}]]</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--JQUERY-->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- FRAMEWORK BOOTSTRAP-->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<!-- Fontawesome-->
<link rel="stylesheet"
	href="https://use.fontawesome.com/releases/v5.0.8/css/solid.css">
<script src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- css-->
<link rel="stylesheet" type="text/css"
	href="static/css/displayActivity.css"
	th:href="@{/css/displayActivity.css}">

<!-- video modal popup -->
<link rel="stylesheet" type="text/css" href="static/css/videoPopup.css"
	th:href="@{/css/videoPopup.css}">
<link rel="stylesheet" type="text/css" href="static/css/profile.css"
	th:href="@{/css/profile.css}">
<script src="static/js/videopopup.js" th:src="@{/js/videopopup.js}"></script>


</head>
<body>
	<!-- sidenav -->
	<header th:insert="fragments/sidenav :: sidenav"></header>

	<!-- Page content holder -->
	<div class="page-content p-5" id="content">

		<!-- Toggle button -->
		<button id="sidebarCollapse" type="button"
			class="btn btn-light bg-white rounded-pill shadow-sm px-4 mb-4">
			<i class="fa fa-bars mr-2"></i> <small
				class="text-uppercase font-weight-bold">Toggle</small>
		</button>
		
		<div class="row goBackContainer">
			<a
				th:href="@{/user/showAvailableActivities/{bookingId}(bookingId=${bookingId})}"
				class="btn col-md-4 backToSearch">Go Back!</a>
		</div>
		
		<p class="display-4">Activity Information</p>
		<p class="h2">General Activity Information</p>
		<div class="card card-body info-box-activity">
			<div class="row">
				<div class="col-md-4"></div>
				<div class="col-md-4 activity-info-item">
					<svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
						class="bi bi-chat-square-text-fill" fill="rgb(30,144,255)"
						xmlns="http://www.w3.org/2000/svg">
						<path fill-rule="evenodd"
							d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.5a1 1 0 0 0-.8.4l-1.9 2.533a1 1 0 0 1-1.6 0L5.3 12.4a1 1 0 0 0-.8-.4H2a2 2 0 0 1-2-2V2zm3.5 1a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5z" />
					</svg>
					<p>Name: [[${activity.name}]]</p>
				</div>
			</div>
			<div class="row">
				<div class="col-md-4 activity-info-item">
					<svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
						class="bi bi-tag-fill" fill="rgb(30,144,255)"
						xmlns="http://www.w3.org/2000/svg">
						<path fill-rule="evenodd"
							d="M2 1a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l4.586-4.586a1 1 0 0 0 0-1.414l-7-7A1 1 0 0 0 6.586 1H2zm4 3.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
					</svg>
					<p>Price: [[${activity.price}]] â‚¬</p>
				</div>
				<div class="col-md-4 activity-info-item">
					<svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
						class="bi bi-camera-video-fill" fill="rgb(30,144,255)"
						xmlns="http://www.w3.org/2000/svg">
						<path
							d="M2.667 3h6.666C10.253 3 11 3.746 11 4.667v6.666c0 .92-.746 1.667-1.667 1.667H2.667C1.747 13 1 12.254 1 11.333V4.667C1 3.747 1.746 3 2.667 3z" />
						<path
							d="M7.404 8.697l6.363 3.692c.54.313 1.233-.066 1.233-.697V4.308c0-.63-.693-1.01-1.233-.696L7.404 7.304a.802.802 0 0 0 0 1.393z" />
					</svg>
					<p class="video" th:video-url="${activity.videoLink}">Preview</p>
				</div>
				<div class="col-md-4 activity-info-item">
					<svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
						class="bi bi-bar-chart-fill" fill="rgb(30,144,255)"
						xmlns="http://www.w3.org/2000/svg">
						<rect width="4" height="5" x="1" y="10" rx="1" />
						<rect width="4" height="9" x="6" y="6" rx="1" />
						<rect width="4" height="14" x="11" y="1" rx="1" />
					</svg>
					<p>Difficulty: [[${activity.difficulty}]]</p>
				</div>
			</div>
			<hr>
			<div class="row">
				<div class="col-md-12 activity-info-item">
					<svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
						class="bi bi-file-text-fill" fill="rgb(30,144,255)"
						xmlns="http://www.w3.org/2000/svg">
						<path fill-rule="evenodd"
							d="M12 1H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zM5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z" />
					</svg>
					<p>Description: [[${activity.description}]]</p>
				</div>
			</div>
		</div>
		<br>

		<p class="h2">Average Rating Information</p>
		<span class="heading"> User Rating
			[[${activity.getRatingsMedian()}]] </span>
		<div th:id="'rating'+${activity.activityId}">
			<script th:inline="javascript">
												function calcStars(var1, var2){
													var x = document.getElementById(var1);
													
													let diff = 5-Math.floor(var2);
													console.log(diff);
													for(let i = 1 ; i <= var2 ; i++){
														x.innerHTML += '<span class="fa fa-star checked"></span>';
													}
													for(let i = 1 ; i <= diff ; i++){
														x.innerHTML += '<span class="fa fa-star"></span>';
													}
												}
												calcStars("rating"+/*[[${activity.activityId}]]*/,/*[[${activity.getRatingsMedian()}]]*/);
											</script>
		</div>
		<p>[[${activity.getRatingsMedian()}]] average based on
			[[${activity.ratings.size()}]] reviews.</p>
		<br>

		<div th:switch="${ratings.size()}">
			<div th:case="0">
				<p class="display-4">No Ratings found, be the first person to
					experience this activity!</p>
			</div>
			<div th:case="*">
				<p class="h2">User Ratings</p>
				<div class="info-box">
					<div th:each="rating : ${ratings}" class="card my-card"
						style="width: 17rem;">
						<div class="card-header my-card-header">
							<img
								th:src="'/img/userProfilePictures/'+ ${rating.user.getProfilePicture()}"
								alt="Profile Picture" width="65"
								class="mr-3 rounded-circle img-thumbnail shadow-sm">
							<p>Rated by: [[${rating.user.username}]]</p>
						</div>
						<ul class="list-group list-group-flush">
							<li class="list-group-item my-list-group-items">
								<p>Rated: [[${rating.rating}]]/5</p>
							</li>
							<li class="list-group-item my-list-group-items">
								<p>" [[${rating.comment}]] "</p>
							</li>
							<li class="list-group-item my-list-group-items">
								<p>Date: [[${rating.ratingDate}]]</p>
							</li>
							<li class="list-group-item my-list-group-items">
								<p>Picture Available [[${rating.pictureName}]]</p>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<br>

		<div th:switch="${activitiesAvailabilities.size()}">
			<div th:case="0">
				<p class="display-4">Sorry no booking slots available for your
					dates :(</p>
			</div>
			<div th:case="*">
				<p class="h2">Available Slots</p>
				<table class="table table-striped table-responsive-md">
					<thead>
						<tr>
							<th>Booked by</th>
							<th>Activity</th>
							<th>Start Time</th>
							<th>End Time</th>
							<th>Free Slots</th>
							<th>Book now!</th>
						</tr>
					</thead>
					<tbody>

						<tr th:each="avail : ${activitiesAvailabilities}">
							<td th:text="${avail.bookingActivities.size()}"></td>
							<td th:text="${avail.activity.name}"></td>
							<td th:text="${avail.getStartTimeString()}"></td>
							<td th:text="${avail.getEndTimeString()}"></td>
							<td th:text="${avail.slots}"></td>
							<td><a
								th:href="@{/user/activityAvailable/add/{bookingId}/{activityAvailId}
								(bookingId=${bookingId},activityAvailId=${avail.activityAvailableId})}"
								class="btn btn-primary"> Book now!<i
									class="fa fa-check ml-2" style="color: white;"></i>
							</a></td>
						</tr>

					</tbody>
				</table>
			</div>
		</div>
	</div>
	<script>
		$(function() {
			$(".video").videoPopup();
		});
	</script>
	<script type="text/javascript" src="static/js/sidebar.js"
		th:src="@{/js/sidebar.js}"></script>
</body>
</html>